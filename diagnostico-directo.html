<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîç Diagn√≥stico Directo - Botones YavlGold</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0C1015 0%, #1a1f2e 100%);
      color: #E8ECF2;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      color: #E2C675;
      margin-bottom: 30px;
      font-size: 32px;
      text-shadow: 0 0 20px rgba(226, 198, 117, 0.3);
    }
    
    .status-card {
      background: rgba(18, 22, 28, 0.9);
      border: 2px solid rgba(226, 198, 117, 0.3);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    .status-card h2 {
      color: #E2C675;
      margin-bottom: 15px;
      font-size: 20px;
    }
    
    .test-result {
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    .test-result.success {
      background: rgba(40, 167, 69, 0.1);
      border-color: #28a745;
      color: #28a745;
    }
    
    .test-result.error {
      background: rgba(220, 53, 69, 0.1);
      border-color: #dc3545;
      color: #dc3545;
    }
    
    .test-result.warning {
      background: rgba(255, 193, 7, 0.1);
      border-color: #ffc107;
      color: #ffc107;
    }
    
    .test-result.info {
      background: rgba(23, 162, 184, 0.1);
      border-color: #17a2b8;
      color: #17a2b8;
    }
    
    button {
      background: linear-gradient(135deg, #E2C675, #C9A851);
      color: #0B0E11;
      border: none;
      padding: 15px 30px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin: 10px 0;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(226, 198, 117, 0.3);
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(226, 198, 117, 0.5);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .code-block {
      background: #000;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      border: 1px solid rgba(226, 198, 117, 0.2);
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(226, 198, 117, 0.3);
      border-radius: 50%;
      border-top-color: #E2C675;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .iframe-container {
      margin: 20px 0;
      border: 2px solid rgba(226, 198, 117, 0.3);
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
    }
    
    iframe {
      width: 100%;
      height: 400px;
      border: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç Diagn√≥stico Directo - Botones YavlGold</h1>
    
    <!-- Test 1: Cargar Sitio Real en iframe -->
    <div class="status-card">
      <h2>üì± Test 1: Sitio Real en iFrame</h2>
      <button onclick="loadRealSite()">‚ñ∂Ô∏è Cargar Sitio Real</button>
      <div id="iframe-result"></div>
      <div id="iframe-container" class="iframe-container" style="display:none;">
        <iframe id="real-site" src=""></iframe>
      </div>
    </div>
    
    <!-- Test 2: Fetch y An√°lisis del HTML -->
    <div class="status-card">
      <h2>üî¨ Test 2: An√°lisis del HTML Real</h2>
      <button onclick="analyzeHTML()">‚ñ∂Ô∏è Analizar HTML del Sitio</button>
      <div id="html-result"></div>
    </div>
    
    <!-- Test 3: Verificar index.html Local -->
    <div class="status-card">
      <h2>üìÇ Test 3: Verificar Archivo Local</h2>
      <button onclick="checkLocalFile()">‚ñ∂Ô∏è Verificar index.html Local</button>
      <div id="local-result"></div>
    </div>
    
    <!-- Test 4: Test de JavaScript -->
    <div class="status-card">
      <h2>‚öôÔ∏è Test 4: Verificar JavaScript del Fix</h2>
      <button onclick="testJavaScript()">‚ñ∂Ô∏è Test de JavaScript</button>
      <div id="js-result"></div>
    </div>
    
    <!-- Test 5: Simulaci√≥n de Botones -->
    <div class="status-card">
      <h2>üéØ Test 5: Botones de Prueba Directos</h2>
      <p style="margin-bottom: 15px; color: #C9D0DA;">Si estos botones funcionan, el navegador est√° OK:</p>
      <button onclick="testButton('Bot√≥n 1')">‚úÖ Test Bot√≥n 1</button>
      <button onclick="testButton('Bot√≥n 2')">‚úÖ Test Bot√≥n 2</button>
      <div id="button-result"></div>
    </div>
    
    <!-- Resultados Finales -->
    <div class="status-card">
      <h2>üìä Resumen de Diagn√≥stico</h2>
      <div id="summary"></div>
    </div>
  </div>

  <script>
    const results = {
      realSite: null,
      htmlAnalysis: null,
      localFile: null,
      javascript: null,
      buttons: null
    };

    function addResult(containerId, message, type = 'info') {
      const container = document.getElementById(containerId);
      const div = document.createElement('div');
      div.className = `test-result ${type}`;
      div.innerHTML = message;
      container.appendChild(div);
    }

    function clearResults(containerId) {
      document.getElementById(containerId).innerHTML = '';
    }

    // Test 1: Cargar sitio real
    function loadRealSite() {
      clearResults('iframe-result');
      addResult('iframe-result', '<span class="loading"></span> Cargando sitio real...', 'info');
      
      const container = document.getElementById('iframe-container');
      const iframe = document.getElementById('real-site');
      
      // Intentar cargar el sitio de GitHub Pages
      iframe.src = 'https://yavlpro.github.io/gold/';
      container.style.display = 'block';
      
      iframe.onload = function() {
        clearResults('iframe-result');
        addResult('iframe-result', '‚úÖ Sitio cargado correctamente', 'success');
        addResult('iframe-result', 'üí° Intenta hacer click en los botones del navbar arriba', 'info');
        
        // Intentar acceder al iframe (puede fallar por CORS)
        try {
          const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
          const buttons = iframeDoc.querySelectorAll('.btn');
          addResult('iframe-result', `‚úÖ Detectados ${buttons.length} botones en el navbar`, 'success');
          
          buttons.forEach((btn, i) => {
            const styles = window.getComputedStyle(btn);
            addResult('iframe-result', 
              `Bot√≥n ${i+1}: pointer-events=${styles.pointerEvents}, z-index=${styles.zIndex}`, 
              'info'
            );
          });
          
          results.realSite = 'success';
        } catch(e) {
          addResult('iframe-result', '‚ö†Ô∏è No se puede inspeccionar el iframe (CORS bloqueado)', 'warning');
          addResult('iframe-result', 'üí° Pero puedes interactuar con √©l manualmente arriba', 'info');
          results.realSite = 'partial';
        }
        
        updateSummary();
      };
      
      iframe.onerror = function() {
        clearResults('iframe-result');
        addResult('iframe-result', '‚ùå Error al cargar el sitio', 'error');
        addResult('iframe-result', 'üîç Verifica que el sitio est√© desplegado en GitHub Pages', 'warning');
        results.realSite = 'error';
        updateSummary();
      };
    }

    // Test 2: Analizar HTML
    async function analyzeHTML() {
      clearResults('html-result');
      addResult('html-result', '<span class="loading"></span> Descargando y analizando HTML...', 'info');
      
      try {
        const response = await fetch('https://yavlpro.github.io/gold/');
        const html = await response.text();
        
        clearResults('html-result');
        addResult('html-result', '‚úÖ HTML descargado correctamente', 'success');
        addResult('html-result', `üìè Tama√±o: ${(html.length / 1024).toFixed(2)} KB`, 'info');
        
        // Verificar si contiene el fix
        if (html.includes('fixButtonFunctionality')) {
          addResult('html-result', '‚úÖ Fix de botones encontrado en el HTML', 'success');
        } else {
          addResult('html-result', '‚ùå Fix de botones NO encontrado en el HTML', 'error');
          addResult('html-result', '‚ö†Ô∏è Posible causa: index.html no sincronizado', 'warning');
        }
        
        // Verificar botones en el HTML
        const btnMatches = html.match(/class="btn btn-(outline|primary)"/g);
        if (btnMatches) {
          addResult('html-result', `‚úÖ Encontrados ${btnMatches.length} botones en el HTML`, 'success');
        } else {
          addResult('html-result', '‚ùå No se encontraron botones en el HTML', 'error');
        }
        
        // Verificar CSS
        if (html.includes('pointer-events: auto')) {
          addResult('html-result', '‚úÖ CSS con pointer-events: auto encontrado', 'success');
        } else {
          addResult('html-result', '‚ö†Ô∏è CSS pointer-events: auto no encontrado', 'warning');
        }
        
        // Mostrar fragmento relevante
        const scriptMatch = html.match(/function fixButtonFunctionality[\s\S]{0,300}/);
        if (scriptMatch) {
          addResult('html-result', '<div class="code-block">' + escapeHtml(scriptMatch[0]) + '...</div>', 'info');
        }
        
        results.htmlAnalysis = 'success';
      } catch(e) {
        clearResults('html-result');
        addResult('html-result', '‚ùå Error al descargar HTML: ' + e.message, 'error');
        results.htmlAnalysis = 'error';
      }
      
      updateSummary();
    }

    // Test 3: Verificar archivo local
    async function checkLocalFile() {
      clearResults('local-result');
      addResult('local-result', '<span class="loading"></span> Verificando archivo local...', 'info');
      
      try {
        // Intentar cargar index.html local (puede fallar por seguridad)
        const response = await fetch('../index.html');
        const html = await response.text();
        
        clearResults('local-result');
        addResult('local-result', '‚úÖ Archivo local le√≠do correctamente', 'success');
        
        if (html.includes('fixButtonFunctionality')) {
          addResult('local-result', '‚úÖ Fix presente en archivo local', 'success');
        } else {
          addResult('local-result', '‚ùå Fix NO presente en archivo local', 'error');
          addResult('local-result', 'üí° Ejecuta: cp index-premium.html index.html', 'warning');
        }
        
        results.localFile = 'success';
      } catch(e) {
        clearResults('local-result');
        addResult('local-result', '‚ö†Ô∏è No se puede leer archivo local (esperado en navegador)', 'warning');
        addResult('local-result', 'üí° Verifica manualmente que index.html = index-premium.html', 'info');
        results.localFile = 'skipped';
      }
      
      updateSummary();
    }

    // Test 4: Test de JavaScript
    function testJavaScript() {
      clearResults('js-result');
      addResult('js-result', 'üîß Probando funcionalidad JavaScript...', 'info');
      
      // Crear botones de prueba
      const testContainer = document.createElement('div');
      testContainer.innerHTML = `
        <a href="#login" class="test-btn-outline">Test Login</a>
        <a href="#register" class="test-btn-primary">Test Register</a>
      `;
      document.body.appendChild(testContainer);
      
      const btn1 = testContainer.querySelector('.test-btn-outline');
      const btn2 = testContainer.querySelector('.test-btn-primary');
      
      // Aplicar estilos inline (simulando el fix)
      [btn1, btn2].forEach(btn => {
        btn.style.pointerEvents = 'auto';
        btn.style.cursor = 'pointer';
        btn.style.zIndex = '100';
        btn.style.position = 'relative';
        btn.style.display = 'inline-block';
        btn.style.padding = '10px 20px';
        btn.style.margin = '5px';
        btn.style.background = '#E2C675';
        btn.style.color = '#0B0E11';
        btn.style.borderRadius = '8px';
        btn.style.textDecoration = 'none';
      });
      
      // A√±adir listeners
      let clicks = 0;
      btn1.addEventListener('click', (e) => {
        e.preventDefault();
        clicks++;
        addResult('js-result', `‚úÖ Click ${clicks} detectado en Test Login`, 'success');
      });
      
      btn2.addEventListener('click', (e) => {
        e.preventDefault();
        clicks++;
        addResult('js-result', `‚úÖ Click ${clicks} detectado en Test Register`, 'success');
      });
      
      addResult('js-result', '‚úÖ Botones de prueba creados:', 'success');
      addResult('js-result', testContainer.outerHTML, 'info');
      addResult('js-result', 'üí° Haz click en los botones de arriba ‚¨ÜÔ∏è', 'info');
      
      results.javascript = 'success';
      updateSummary();
    }

    // Test 5: Botones directos
    function testButton(name) {
      addResult('button-result', `‚úÖ ${name} clickeado correctamente!`, 'success');
      results.buttons = 'success';
      updateSummary();
    }

    function updateSummary() {
      const summary = document.getElementById('summary');
      summary.innerHTML = '<h3 style="color: #E2C675; margin-bottom: 15px;">Estado de Tests:</h3>';
      
      const tests = [
        { name: 'Sitio Real', result: results.realSite },
        { name: 'An√°lisis HTML', result: results.htmlAnalysis },
        { name: 'Archivo Local', result: results.localFile },
        { name: 'JavaScript', result: results.javascript },
        { name: 'Botones Prueba', result: results.buttons }
      ];
      
      tests.forEach(test => {
        let icon = '‚è≥';
        let type = 'info';
        
        if (test.result === 'success') { icon = '‚úÖ'; type = 'success'; }
        else if (test.result === 'error') { icon = '‚ùå'; type = 'error'; }
        else if (test.result === 'warning' || test.result === 'partial') { icon = '‚ö†Ô∏è'; type = 'warning'; }
        else if (test.result === 'skipped') { icon = '‚è≠Ô∏è'; type = 'info'; }
        
        addResult('summary', `${icon} <strong>${test.name}:</strong> ${test.result || 'Pendiente'}`, type);
      });
      
      // Conclusi√≥n
      const hasErrors = Object.values(results).includes('error');
      const allSuccess = Object.values(results).every(r => r === 'success' || r === 'partial' || r === 'skipped');
      
      if (allSuccess) {
        addResult('summary', '<br><strong>üéâ TODOS LOS TESTS PASARON</strong><br>Si los botones siguen sin funcionar, el problema puede estar en:<br>1. Cach√© del navegador (Ctrl+Shift+R)<br>2. GitHub Pages no actualizado (espera 2-3 min)<br>3. Alg√∫n bloqueador de scripts', 'success');
      } else if (hasErrors) {
        addResult('summary', '<br><strong>‚ö†Ô∏è SE DETECTARON ERRORES</strong><br>Revisa los tests marcados con ‚ùå arriba', 'error');
      }
    }

    function escapeHtml(text) {
      const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
      };
      return text.replace(/[&<>"']/g, m => map[m]);
    }

    // Auto-ejecutar algunos tests
    window.addEventListener('DOMContentLoaded', () => {
      console.log('üß™ Diagn√≥stico directo iniciado');
      addResult('summary', '‚è≥ Ejecuta los tests haciendo click en los botones arriba', 'info');
    });
  </script>
</body>
</html>
